<!DOCTYPE html>
<html lang="zh-CN">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <title>普罗米修斯Prometheus - 在阅读中遇见自己</title><meta name="Description" content="这是我的全新 博客 网站"><meta property="og:title" content="普罗米修斯Prometheus" />
<meta property="og:description" content="1、prometheus 主服务的下载与部署 1.1创建安装目录和下载部署包并解压 下载x86安装包 1 2 3 4 5 6 mkdir -p /data/monitor/prometheus #下载prometheus包" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://freerun.xyz/prometheus-%E7%9B%91%E6%8E%A7%E9%83%A8%E7%BD%B2-last/" /><meta property="og:image" content="https://freerun.xyz/favicon.jpg"/><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-10-20T11:40:40&#43;08:00" />
<meta property="article:modified_time" content="2021-10-20T11:40:40&#43;08:00" />

<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://freerun.xyz/favicon.jpg"/>

<meta name="twitter:title" content="普罗米修斯Prometheus"/>
<meta name="twitter:description" content="1、prometheus 主服务的下载与部署 1.1创建安装目录和下载部署包并解压 下载x86安装包 1 2 3 4 5 6 mkdir -p /data/monitor/prometheus #下载prometheus包"/>
<meta name="application-name" content="我的网站">
<meta name="apple-mobile-web-app-title" content="我的网站"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="icon" href="/favicon.jpg"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://freerun.xyz/prometheus-%E7%9B%91%E6%8E%A7%E9%83%A8%E7%BD%B2-last/" /><link rel="prev" href="https://freerun.xyz/linux%E6%89%A9%E5%AE%B9home%E7%9B%AE%E5%BD%95/" /><link rel="next" href="https://freerun.xyz/linux%E7%B3%BB%E7%BB%9F%E4%B8%8B%E6%8F%90%E7%A4%BA%E7%A3%81%E7%9B%98%E7%A9%BA%E9%97%B4%E6%BB%A1%E4%BD%86%E5%AE%9E%E9%99%85%E5%8D%A0%E7%94%A8%E5%8D%B4%E5%BE%88%E5%B0%8F/" /><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/normalize.css@8.0.1/normalize.min.css"><link rel="stylesheet" href="/css/style.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css"><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "普罗米修斯Prometheus",
        "inLanguage": "zh-CN",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/freerun.xyz\/prometheus-%E7%9B%91%E6%8E%A7%E9%83%A8%E7%BD%B2-last\/"
        },"image": ["https:\/\/freerun.xyz\/images\/Apple-Devices-Preview.png"],"genre": "posts","keywords": "监控","wordcount":  3563 ,
        "url": "https:\/\/freerun.xyz\/prometheus-%E7%9B%91%E6%8E%A7%E9%83%A8%E7%BD%B2-last\/","datePublished": "2021-10-20T11:40:40+08:00","dateModified": "2021-10-20T11:40:40+08:00","publisher": {
            "@type": "Organization",
            "name": ""},"author": {
                "@type": "Person",
                "name": "Ylimhs"
            },"description": ""
    }
    </script></head>
    <body data-header-desktop="fixed" data-header-mobile="normal"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="在阅读中遇见自己"><span class="header-title-pre"><i class='fa fa-cloud'></i></span>早起的年轻人&amp;首页</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/"><i class='fas fa-fw fa-book'></i> 文章 </a><a class="menu-item" href="/tags/"><i class='fas fa-fw fa-tag'></i> 标签 </a><a class="menu-item" href="/categories/"><i class='fas fa-fw fa-th'></i> 分类 </a><a class="menu-item" href="/abouts/"><i class='fas fa-fw fa-at'></i> 关于 </a><a class="menu-item" href="https://github.com/liuxiaoquan" title="GitHub" rel="noopener noreffer" target="_blank"><i class='fab fa-github fa-fw'></i> Github </a><a class="menu-item" href="https://hugoloveit.com/zh-cn/posts/" rel="noopener noreffer" target="_blank"><i class='fas fa-user-friends'></i> 友链 </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="搜索文章标题或内容..." id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="搜索">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="清空">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="切换主题">
                    <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
                </a>
            </div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="在阅读中遇见自己"><span class="header-title-pre"><i class='fa fa-cloud'></i></span>早起的年轻人&amp;首页</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="搜索文章标题或内容..." id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="搜索">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="清空">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        取消
                    </a>
                </div><a class="menu-item" href="/posts/" title=""><i class='fas fa-fw fa-book'></i>文章</a><a class="menu-item" href="/tags/" title=""><i class='fas fa-fw fa-tag'></i>标签</a><a class="menu-item" href="/categories/" title=""><i class='fas fa-fw fa-th'></i>分类</a><a class="menu-item" href="/abouts/" title=""><i class='fas fa-fw fa-at'></i>关于</a><a class="menu-item" href="https://github.com/liuxiaoquan" title="GitHub" rel="noopener noreffer" target="_blank"><i class='fab fa-github fa-fw'></i>Github</a><a class="menu-item" href="https://hugoloveit.com/zh-cn/posts/" title="" rel="noopener noreffer" target="_blank"><i class='fas fa-user-friends'></i>友链</a><a href="javascript:void(0);" class="menu-item theme-switch" title="切换主题">
                <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
            </a></div>
    </div>
</header><div class="search-dropdown desktop">
        <div id="search-dropdown-desktop"></div>
    </div>
    <div class="search-dropdown mobile">
        <div id="search-dropdown-mobile"></div>
    </div><main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">目录</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">普罗米修斯Prometheus</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="https://github.com/liuxiaoquan/free-programming-books-zh_CN" title="Author" target="_blank" rel="noopener noreffer author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>Ylimhs</a>
</span>&nbsp;<span class="post-category">收录于 <a href="/categories/%E8%BF%90%E7%BB%B4/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>运维</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw" aria-hidden="true"></i>&nbsp;<time datetime="2021-10-20">2021-10-20</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden="true"></i>&nbsp;约 3563 字&nbsp;
                <i class="far fa-clock fa-fw" aria-hidden="true"></i>&nbsp;预计阅读 8 分钟&nbsp;<span id="/prometheus-%E7%9B%91%E6%8E%A7%E9%83%A8%E7%BD%B2-last/" class="leancloud_visitors" data-flag-title="普罗米修斯Prometheus">
                        <i class="far fa-eye fa-fw" aria-hidden="true"></i>&nbsp;<span class=leancloud-visitors-count></span>&nbsp;次阅读
                    </span>&nbsp;</div>
        </div><div class="details toc" id="toc-static"  data-kept="">
                <div class="details-summary toc-title">
                    <span>目录</span>
                    <span><i class="details-icon fas fa-angle-right" aria-hidden="true"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#1prometheus-主服务的下载与部署">1、prometheus 主服务的下载与部署</a>
          <ul>
            <li><a href="#11创建安装目录和下载部署包并解压--下载x86安装包packageprometheus-2271linux-amd64targz">1.1创建安装目录和下载部署包并解压  <a href="/package/prometheus-2.27.1.linux-amd64.tar.gz">下载x86安装包</a></a></li>
            <li><a href="#12配置prometheus启动文件">1.2配置Prometheus启动文件</a></li>
            <li><a href="#13-设置prometheus开机自启动">1.3 设置Prometheus开机自启动</a></li>
            <li><a href="#14-测试验证prometheus是否启动成功访问-ip9090prometheus">1.4 测试，验证Prometheus是否启动成功：访问 IP:9090/prometheus/</a></li>
          </ul>
        </li>
        <li><a href="#2部署-exporter采集节点信息">2、部署 exporter采集节点信息</a>
          <ul>
            <li><a href="#21创建安装目录和下载部署包并解压--下载x86安装包packagenode_exporter-112linux-amd64targz-使用-uname--a查询架构下载arm安装包packagenode_exporter-112linux-arm64targz">2.1创建安装目录和下载部署包并解压  <a href="/package/node_exporter-1.1.2.linux-amd64.tar.gz">下载x86安装包</a> 使用 uname -a查询架构，<a href="/package/node_exporter-1.1.2.linux-arm64.tar.gz">下载arm安装包</a></a></li>
            <li><a href="#22配置node_exporter-服务">2.2配置node_exporter 服务</a></li>
            <li><a href="#23-设置node_exporter开机自启动">2.3 设置node_exporter开机自启动</a></li>
            <li><a href="#24-测试验证node_exporter是否启动成功访问-ip9100">2.4 测试，验证node_exporter是否启动成功：访问 IP:9100</a></li>
            <li><a href="#25-把-node_exporter-这个采集程序接配置到prometheusyml">2.5 把 node_exporter 这个采集程序接⼊配置到prometheus.yml</a></li>
          </ul>
        </li>
        <li><a href="#3安装grafana展示">3、安装grafana展示</a>
          <ul>
            <li><a href="#31-创建安装目录与下载部署包--下载x86安装包packagegrafana-757linux-amd64targz">3.1 创建安装目录与下载部署包  <a href="/package/grafana-7.5.7.linux-amd64.tar.gz">下载x86安装包</a></a></li>
            <li><a href="#32-配置grafana-服务--下载grafana启动文件启动文件grafanaservice">3.2 配置grafana 服务  <a href="/%E5%90%AF%E5%8A%A8%E6%96%87%E4%BB%B6/grafana.service">下载grafana启动文件</a></a></li>
            <li><a href="#33-设置grafana-开机自启动">3.3 设置grafana 开机自启动</a></li>
            <li><a href="#34-测试访问ip3000默认登录账户和密码都是admin进后界面如下">3.4 测试，访问：ip:3000（默认登录账户和密码都是admin，进⼊后界面如下）</a></li>
          </ul>
        </li>
        <li><a href="#4监控配置">4、监控配置</a>
          <ul>
            <li><a href="#41-查看prometheus管理后台是否有采集到服务器的信息">4.1 查看Prometheus管理后台是否有采集到服务器的信息</a></li>
            <li><a href="#42-配置grafana管理后台">4.2 配置grafana管理后台</a></li>
            <li><a href="#43-导监控模板保存基础监控大盘官网下载地址httpsgrafanacomgrafanadashboards8919-注释与官网下载的基础监控大盘一样选择一个下载就行大盘配置基础监控大盘json">4.3 导⼊监控模板，保存。<a href="https://grafana.com/grafana/dashboards/8919">基础监控大盘官网下载地址</a> 注释：<a href="/%E5%A4%A7%E7%9B%98%E9%85%8D%E7%BD%AE/%E5%9F%BA%E7%A1%80%E7%9B%91%E6%8E%A7%E5%A4%A7%E7%9B%98.json">与官网下载的基础监控大盘一样，选择一个下载就行</a></a></li>
            <li><a href="#44查看服务器的基础监控">4.4查看服务器的基础监控</a></li>
          </ul>
        </li>
        <li><a href="#5监控里约网关接调用情况">5、监控里约网关接⼝调用情况</a>
          <ul>
            <li><a href="#1添加-es-数据源">1.添加 ES 数据源</a></li>
            <li><a href="#2导-json-模板rio-sg-access日志大盘-1617280890686json下载日志大盘大盘配置rio-sg-access日志大盘-1617280890686json">2.导⼊ json 模板（Rio-SG-Access日志大盘-1617280890686.json）<a href="/%E5%A4%A7%E7%9B%98%E9%85%8D%E7%BD%AE/Rio-SG-Access%E6%97%A5%E5%BF%97%E5%A4%A7%E7%9B%98-1617280890686.json">下载日志大盘</a></a></li>
          </ul>
        </li>
        <li><a href="#6部署部-mysqld_exporter采集节点信息"><strong>6</strong>、部署部 mysqld_exporter采集节点信息</a>
          <ul>
            <li><a href="#61在数据库服务器上执行以下操作在">6.1在数据库服务器上执行以下操作在</a>
              <ul>
                <li><a href="#611官网下载包httpsprometheusiodownloadmysqld_exporter----注释与官网下载的安装包一样选一个下载就行packagemysqld_exporter-0130linux-amd64targz"><strong>6.1.1</strong><a href="https://prometheus.io/download/#mysqld_exporter">官网下载包</a>    注释：<a href="/package/mysqld_exporter-0.13.0.linux-amd64.tar.gz">与官网下载的安装包一样，选一个下载就行</a></a></li>
                <li><a href="#612配置mycnf"><strong>6.1.2</strong>配置.my.cnf</a></li>
                <li><a href="#613启动">6.1.3启动</a></li>
                <li><a href="#614-启动后的访问端是-启-9104访问访-http数据库服务器-数-ip9104metrics">6.1.4 启动后的访问端⼝是 启 9104：访问访 http://数据库服务器 数 ip:9104/metrics</a></li>
              </ul>
            </li>
            <li><a href="#62-把-mysql_exporter-这个采集程序接配置到-这-prometheusyml-参照下图参考文件prometheusyml">6.2 把 mysql_exporter 这个采集程序接⼊配置到 这 prometheus.yml 参照下图<a href="/prometheus.yml">参考文件</a></a></li>
            <li><a href="#63配置配-grafana管理后台这一步可以省略">6.3配置配 grafana管理后台(这一步可以省略)</a>
              <ul>
                <li><a href="#631-上传上-mysql监控模板--下载更多面板链接httpsgrafanacomgrafanadashboardssearchmysql">6.3.1 上传上 mysql监控模板  <a href="https://grafana.com/grafana/dashboards?search=mysql">下载更多面板链接</a></a></li>
              </ul>
            </li>
          </ul>
        </li>
        <li><a href="#7-设置邮件告警">7、 设置邮件告警</a>
          <ul>
            <li><a href="#2配置通知邮箱-配-在-grafana">2、配置通知邮箱 配 在 grafana</a></li>
          </ul>
        </li>
        <li><a href="#8设置其他告警演示设置企业微信群告警">8、设置其他告警，演示设置企业微信群告警</a>
          <ul>
            <li><a href="#81启动">8.1启动</a></li>
            <li><a href="#82-企业微信告警配置">8.2 企业微信告警配置</a>
              <ul>
                <li><a href="#grafana内置固定消息模版接入配置">grafana（内置固定消息模版）接入配置</a></li>
              </ul>
            </li>
          </ul>
        </li>
        <li><a href="#9参考文档">9.参考文档</a></li>
      </ul>
    </li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><h2 id="1prometheus-主服务的下载与部署">1、prometheus 主服务的下载与部署</h2>
<h3 id="11创建安装目录和下载部署包并解压--下载x86安装包packageprometheus-2271linux-amd64targz">1.1创建安装目录和下载部署包并解压  <a href="/package/prometheus-2.27.1.linux-amd64.tar.gz" rel="">下载x86安装包</a>
</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">mkdir -p /data/monitor/prometheus
<span class="c1">#下载prometheus包，pakage文件夹中有下载好的包</span>
<span class="c1">#wget https://github.com/prometheus/prometheus/releases/download/v2.27.1/prometheus-2.27.1.linux-amd64.tar.gz</span>

<span class="c1">#解压prometheus包，并且解压后/data/monitor/prometheus里去除prometheus-2.27.1.linux-amd64文件目录</span>
tar -zxvf prometheus-2.27.1.linux-amd64.tar.gz -C /data/monitor/prometheus --strip-components <span class="m">1</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="12配置prometheus启动文件">1.2配置Prometheus启动文件</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">cat &gt; /etc/systemd/system/prometheus.service <span class="s">&lt;&lt; EOF
</span><span class="s">[Unit]
</span><span class="s">Description=prometheus Service
</span><span class="s">After=network.target
</span><span class="s">After=network-online.target
</span><span class="s">Wants=network-online.target
</span><span class="s">[Service]
</span><span class="s">Type=simple
</span><span class="s">WorkingDirectory=/data/monitor/prometheus
</span><span class="s">ExecStart=/data/monitor/prometheus/prometheus --config.file=prometheus.yml --web.enable-lifecycle --web.external-url=/prometheus
</span><span class="s">ExecStop=/usr/bin/curl -X POST http://localhost:9090/prometheus/-/quit
</span><span class="s">Restart=on-failure
</span><span class="s">RestartSec=5
</span><span class="s">LimitNOFILE=65536
</span><span class="s">[Install]
</span><span class="s">WantedBy=multi-user.target
</span><span class="s">EOF</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>注：可以把启动文件直接放到/etc/systemd/system/目录下</strong>    <a href="/%e5%90%af%e5%8a%a8%e6%96%87%e4%bb%b6/prometheus.service" rel="">下载prometheus启动文件</a>
</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/image/20210721150157.png"
        data-srcset="/image/20210721150157.png, /image/20210721150157.png 1.5x, /image/20210721150157.png 2x"
        data-sizes="auto"
        alt="/image/20210721150157.png"
        title="image-20210721145922404" /></p>
<h3 id="13-设置prometheus开机自启动">1.3 设置Prometheus开机自启动</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">systemctl daemon-reload
systemctl <span class="nb">enable</span> prometheus
systemctl start prometheus
</code></pre></td></tr></table>
</div>
</div><h3 id="14-测试验证prometheus是否启动成功访问-ip9090prometheus">1.4 测试，验证Prometheus是否启动成功：访问 IP:9090/prometheus/</h3>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/image/image-20210721145210131.png"
        data-srcset="/image/image-20210721145210131.png, /image/image-20210721145210131.png 1.5x, /image/image-20210721145210131.png 2x"
        data-sizes="auto"
        alt="/image/image-20210721145210131.png"
        title="/image/image-20210721145210131.png" /></p>
<h2 id="2部署-exporter采集节点信息">2、部署 exporter采集节点信息</h2>
<h3 id="21创建安装目录和下载部署包并解压--下载x86安装包packagenode_exporter-112linux-amd64targz-使用-uname--a查询架构下载arm安装包packagenode_exporter-112linux-arm64targz">2.1创建安装目录和下载部署包并解压  <a href="/package/node_exporter-1.1.2.linux-amd64.tar.gz" rel="">下载x86安装包</a>
 使用 uname -a查询架构，<a href="/package/node_exporter-1.1.2.linux-arm64.tar.gz" rel="">下载arm安装包</a>
</h3>
<p><strong>(其他版本下载地址：https://github.com/prometheus/node_exporter/releases)</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">mkdir -p /data/monitor/node_exporter
<span class="c1">#wget https://github.com/prometheus/node_exporter/releases/download/v1.1.2/node_exporter-1.1.2.linux-amd64.tar.gz</span>
tar -zxvf node_exporter-1.1.2.linux-amd64.tar.gz -C /data/monitor/node_exporter --strip-components <span class="m">1</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="22配置node_exporter-服务">2.2配置node_exporter 服务</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">cat &gt; /etc/systemd/system/node_exporter.service <span class="s">&lt;&lt;EOF
</span><span class="s">[Unit]
</span><span class="s">Description=node-exporter Service
</span><span class="s">After=network.target
</span><span class="s">After=network-online.target
</span><span class="s">Wants=network-online.target
</span><span class="s">[Service]
</span><span class="s">Type=simple
</span><span class="s">WorkingDirectory=/data/monitor/node_exporter
</span><span class="s">ExecStart=/data/monitor/node_exporter/node_exporter --web.listen-address=0.0.0.0:9100
</span><span class="s">Restart=on-failure
</span><span class="s">RestartSec=5
</span><span class="s">LimitNOFILE=65536
</span><span class="s">[Install]
</span><span class="s">WantedBy=multi-user.target
</span><span class="s">EOF</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>注：可以把启动文件直接放到/etc/systemd/system/目录下</strong>     <a href="/%e5%90%af%e5%8a%a8%e6%96%87%e4%bb%b6/node-exporter.service" rel="">下载node-exporter启动文件</a>
</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/image/20210721150157.png"
        data-srcset="/image/20210721150157.png, /image/20210721150157.png 1.5x, /image/20210721150157.png 2x"
        data-sizes="auto"
        alt="/image/20210721150157.png"
        title="image-20210721145922404" /></p>
<h3 id="23-设置node_exporter开机自启动">2.3 设置node_exporter开机自启动</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">systemctl daemon-reload
systemctl <span class="nb">enable</span> node-exporter
systemctl start node-exporter
</code></pre></td></tr></table>
</div>
</div><h3 id="24-测试验证node_exporter是否启动成功访问-ip9100">2.4 测试，验证node_exporter是否启动成功：访问 IP:9100</h3>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/image/20210721150439.png"
        data-srcset="/image/20210721150439.png, /image/20210721150439.png 1.5x, /image/20210721150439.png 2x"
        data-sizes="auto"
        alt="/image/20210721150439.png"
        title="/image/20210721150439.png" /></p>
<h3 id="25-把-node_exporter-这个采集程序接配置到prometheusyml">2.5 把 node_exporter 这个采集程序接⼊配置到prometheus.yml</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-yaml" data-lang="yaml"><span class="c"># my global config</span><span class="w">
</span><span class="w"></span><span class="nt">global</span><span class="p">:</span><span class="w">
</span><span class="w">  </span><span class="nt">scrape_interval</span><span class="p">:</span><span class="w">     </span><span class="l">15s</span><span class="w"> </span><span class="c"># Set the scrape interval to every 15 seconds. Default is every 1 minute.</span><span class="w">
</span><span class="w">  </span><span class="nt">evaluation_interval</span><span class="p">:</span><span class="w"> </span><span class="l">15s</span><span class="w"> </span><span class="c"># Evaluate rules every 15 seconds. The default is every 1 minute.</span><span class="w">
</span><span class="w">  </span><span class="c"># scrape_timeout is set to the global default (10s).</span><span class="w">
</span><span class="w">
</span><span class="w"></span><span class="c"># Alertmanager configuration</span><span class="w">
</span><span class="w"></span><span class="nt">alerting</span><span class="p">:</span><span class="w">
</span><span class="w">  </span><span class="nt">alertmanagers</span><span class="p">:</span><span class="w">
</span><span class="w">  </span>- <span class="nt">static_configs</span><span class="p">:</span><span class="w">
</span><span class="w">    </span>- <span class="nt">targets</span><span class="p">:</span><span class="w">
</span><span class="w">      </span><span class="c"># - alertmanager:9093</span><span class="w">
</span><span class="w">
</span><span class="w"></span><span class="c"># Load rules once and periodically evaluate them according to the global &#39;evaluation_interval&#39;.</span><span class="w">
</span><span class="w"></span><span class="nt">rule_files</span><span class="p">:</span><span class="w">
</span><span class="w">  </span><span class="c"># - &#34;first_rules.yml&#34;</span><span class="w">
</span><span class="w">  </span><span class="c"># - &#34;second_rules.yml&#34;</span><span class="w">
</span><span class="w">
</span><span class="w"></span><span class="c"># A scrape configuration containing exactly one endpoint to scrape:</span><span class="w">
</span><span class="w"></span><span class="c"># Here it&#39;s Prometheus itself.</span><span class="w">
</span><span class="w"></span><span class="nt">scrape_configs</span><span class="p">:</span><span class="w">
</span><span class="w">  </span><span class="c"># The job name is added as a label `job=&lt;job_name&gt;` to any timeseries scraped from this config.</span><span class="w">
</span><span class="w">  </span>- <span class="nt">job_name</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;prometheus&#39;</span><span class="w">
</span><span class="w">
</span><span class="w">    </span><span class="c"># metrics_path defaults to &#39;/metrics&#39;</span><span class="w">
</span><span class="w">    </span><span class="c"># scheme defaults to &#39;http&#39;.</span><span class="w">
</span><span class="w">
</span><span class="w">    </span><span class="nt">static_configs</span><span class="p">:</span><span class="w">
</span><span class="w">    </span>- <span class="nt">targets</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;localhost:9090&#39;</span><span class="p">]</span><span class="w">
</span><span class="w">    
</span><span class="w">  </span>- <span class="nt">job_name</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;node-exporter&#39;</span><span class="w">
</span><span class="w">    
</span><span class="w">    </span><span class="nt">scrape_interval</span><span class="p">:</span><span class="w"> </span><span class="l">5s</span><span class="w">
</span><span class="w">    </span><span class="nt">static_configs</span><span class="p">:</span><span class="w">
</span><span class="w">    </span>- <span class="nt">targets</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;localhost:9100&#39;</span><span class="p">,</span><span class="s1">&#39;10.9.0.1:9100&#39;</span><span class="p">]</span><span class="w">
</span><span class="w">      </span><span class="nt">labels</span><span class="p">:</span><span class="w"> 
</span><span class="w">        </span><span class="nt">group</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;web&#39;</span><span class="w">
</span><span class="w">        </span><span class="nt">annotation</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;节点信息采集&#39;</span><span class="w">
</span></code></pre></td></tr></table>
</div>
</div><p><strong>导⼊node_exporter 后，重新载⼊配置 :</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">curl -X POST http://localhost:9090/prometheus/-/reload
</code></pre></td></tr></table>
</div>
</div><h2 id="3安装grafana展示">3、安装grafana展示</h2>
<h3 id="31-创建安装目录与下载部署包--下载x86安装包packagegrafana-757linux-amd64targz">3.1 创建安装目录与下载部署包  <a href="/package/grafana-7.5.7.linux-amd64.tar.gz" rel="">下载x86安装包</a>
</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">mkdir -p /data/monitor/grafana
<span class="c1">#wget https://dl.grafana.com/oss/release/grafana-7.5.7.linux-amd64.tar.gz</span>
tar -zxvf grafana-7.5.7.linux-amd64.tar.gz -C /data/monitor/grafana --strip-components <span class="m">1</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="32-配置grafana-服务--下载grafana启动文件启动文件grafanaservice">3.2 配置grafana 服务  <a href="/%e5%90%af%e5%8a%a8%e6%96%87%e4%bb%b6/grafana.service" rel="">下载grafana启动文件</a>
</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">cat &gt; /etc/systemd/system/grafana.service <span class="s">&lt;&lt;EOF
</span><span class="s">[Unit]
</span><span class="s">Description=grafana Service
</span><span class="s">After=network.target
</span><span class="s">After=network-online.target
</span><span class="s">Wants=network-online.target
</span><span class="s">[Service]
</span><span class="s">Type=simple
</span><span class="s">WorkingDirectory=/data/monitor/grafana
</span><span class="s">ExecStart=/data/monitor/grafana/bin/grafana-server web
</span><span class="s">Restart=on-failure
</span><span class="s">RestartSec=5
</span><span class="s">LimitNOFILE=65536
</span><span class="s">[Install]
</span><span class="s">WantedBy=multi-user.target
</span><span class="s">EOF</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="33-设置grafana-开机自启动">3.3 设置grafana 开机自启动</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">systemctl daemon-reload
systemctl <span class="nb">enable</span> grafanasy
stemctl start grafana
</code></pre></td></tr></table>
</div>
</div><h3 id="34-测试访问ip3000默认登录账户和密码都是admin进后界面如下">3.4 测试，访问：ip:3000（默认登录账户和密码都是admin，进⼊后界面如下）</h3>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/image/20210721151249.png"
        data-srcset="/image/20210721151249.png, /image/20210721151249.png 1.5x, /image/20210721151249.png 2x"
        data-sizes="auto"
        alt="/image/20210721151249.png"
        title="/image/20210721151249.png" /></p>
<h2 id="4监控配置">4、监控配置</h2>
<h3 id="41-查看prometheus管理后台是否有采集到服务器的信息">4.1 查看Prometheus管理后台是否有采集到服务器的信息</h3>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/image/20210721151516.png"
        data-srcset="/image/20210721151516.png, /image/20210721151516.png 1.5x, /image/20210721151516.png 2x"
        data-sizes="auto"
        alt="/image/20210721151516.png"
        title="/image/20210721151516.png" /></p>
<h3 id="42-配置grafana管理后台">4.2 配置grafana管理后台</h3>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/image/20210721151856.png"
        data-srcset="/image/20210721151856.png, /image/20210721151856.png 1.5x, /image/20210721151856.png 2x"
        data-sizes="auto"
        alt="/image/20210721151856.png"
        title="/image/20210721151856.png" /></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/image/20210721152103.png"
        data-srcset="/image/20210721152103.png, /image/20210721152103.png 1.5x, /image/20210721152103.png 2x"
        data-sizes="auto"
        alt="/image/20210721152103.png"
        title="/image/20210721152103.png" /></p>
<h3 id="43-导监控模板保存基础监控大盘官网下载地址httpsgrafanacomgrafanadashboards8919-注释与官网下载的基础监控大盘一样选择一个下载就行大盘配置基础监控大盘json">4.3 导⼊监控模板，保存。<a href="https://grafana.com/grafana/dashboards/8919" target="_blank" rel="noopener noreffer">基础监控大盘官网下载地址</a>
 注释：<a href="/%e5%a4%a7%e7%9b%98%e9%85%8d%e7%bd%ae/%e5%9f%ba%e7%a1%80%e7%9b%91%e6%8e%a7%e5%a4%a7%e7%9b%98.json" rel="">与官网下载的基础监控大盘一样，选择一个下载就行</a>
</h3>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/image/20210721152332.png"
        data-srcset="/image/20210721152332.png, /image/20210721152332.png 1.5x, /image/20210721152332.png 2x"
        data-sizes="auto"
        alt="/image/20210721152332.png"
        title="/image/20210721152332.png" /></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/image/20210721152507.png"
        data-srcset="/image/20210721152507.png, /image/20210721152507.png 1.5x, /image/20210721152507.png 2x"
        data-sizes="auto"
        alt="/image/20210721152507.png"
        title="/image/20210721152507.png" /></p>
<h3 id="44查看服务器的基础监控">4.4查看服务器的基础监控</h3>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/image/20210721152632.png"
        data-srcset="/image/20210721152632.png, /image/20210721152632.png 1.5x, /image/20210721152632.png 2x"
        data-sizes="auto"
        alt="/image/20210721152632.png"
        title="/image/20210721152632.png" /></p>
<h2 id="5监控里约网关接调用情况">5、监控里约网关接⼝调用情况</h2>
<h3 id="1添加-es-数据源">1.添加 ES 数据源</h3>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/image/20210721152826.png"
        data-srcset="/image/20210721152826.png, /image/20210721152826.png 1.5x, /image/20210721152826.png 2x"
        data-sizes="auto"
        alt="/image/20210721152826.png"
        title="/image/20210721152826.png" /></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/image/20210721153059.png"
        data-srcset="/image/20210721153059.png, /image/20210721153059.png 1.5x, /image/20210721153059.png 2x"
        data-sizes="auto"
        alt="/image/20210721153059.png"
        title="/image/20210721153059.png" /></p>
<h3 id="2导-json-模板rio-sg-access日志大盘-1617280890686json下载日志大盘大盘配置rio-sg-access日志大盘-1617280890686json">2.导⼊ json 模板（Rio-SG-Access日志大盘-1617280890686.json）<a href="/%e5%a4%a7%e7%9b%98%e9%85%8d%e7%bd%ae/Rio-SG-Access%e6%97%a5%e5%bf%97%e5%a4%a7%e7%9b%98-1617280890686.json" rel="">下载日志大盘</a>
</h3>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/image/20210721153228.png"
        data-srcset="/image/20210721153228.png, /image/20210721153228.png 1.5x, /image/20210721153228.png 2x"
        data-sizes="auto"
        alt="/image/20210721153228.png"
        title="/image/20210721153228.png" /></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/image/20210721172156.png"
        data-srcset="/image/20210721172156.png, /image/20210721172156.png 1.5x, /image/20210721172156.png 2x"
        data-sizes="auto"
        alt="/image/20210721172156.png"
        title="/image/20210721172156.png" /></p>
<h2 id="6部署部-mysqld_exporter采集节点信息"><strong>6</strong>、部署部 mysqld_exporter采集节点信息</h2>
<h3 id="61在数据库服务器上执行以下操作在">6.1在数据库服务器上执行以下操作在</h3>
<h4 id="611官网下载包httpsprometheusiodownloadmysqld_exporter----注释与官网下载的安装包一样选一个下载就行packagemysqld_exporter-0130linux-amd64targz"><strong>6.1.1</strong><a href="https://prometheus.io/download/#mysqld_exporter" target="_blank" rel="noopener noreffer">官网下载包</a>
    注释：<a href="/package/mysqld_exporter-0.13.0.linux-amd64.tar.gz" rel="">与官网下载的安装包一样，选一个下载就行</a>
</h4>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/image/20210721193725.png"
        data-srcset="/image/20210721193725.png, /image/20210721193725.png 1.5x, /image/20210721193725.png 2x"
        data-sizes="auto"
        alt="/image/20210721193725.png"
        title="/image/20210721193725.png" /></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">mkdir -p /data/monitor/mysqld_exporter
tar -zxvf mysqld_exporter-0.13.0.linux-amd64.tar.gz -C /data/monitor/mysqld_exporter/ --strip-components <span class="m">1</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="612配置mycnf"><strong>6.1.2</strong>配置.my.cnf</h4>
<p>.my.cnf默认放置在启动用户的家目录，启动时无需指定；也可以随意放置在任意目录，在启动时通过 <code>--config.my-cnf={conf_dir}/.my.cnf</code>指定配置文件。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"><span class="c1">#正常这里没有.my.cnf文件，需要创建.my.cnf文件</span>
vim /data/monitor/mysqld_exporter/.my.cnf
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">[client]
host=localhost
user=root
port=3306
password=root # 数据库密码
</code></pre></td></tr></table>
</div>
</div><h4 id="613启动">6.1.3启动</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"><span class="nb">cd</span> /data/monitor/mysqld_exporter/
<span class="c1">#创建start.sh脚本</span>
vim start.sh
</code></pre></td></tr></table>
</div>
</div><p><strong>start.sh脚本内容如下：</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"><span class="cp">#!/bin/bash
</span><span class="cp"></span>nohup ./mysqld_exporter --config.my-cnf<span class="o">=</span>/data/monitor/mysqld_exporter/.my.cnf <span class="p">&amp;</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">chmod <span class="m">744</span> start.sh
</code></pre></td></tr></table>
</div>
</div><p><strong>注册服务</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"><span class="c1">#创建启动文件</span>
vim /etc/systemd/system/mysqld_exporter.service
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"><span class="o">[</span>Unit<span class="o">]</span>
<span class="nv">Description</span><span class="o">=</span>mysqld_exporter service
<span class="nv">After</span><span class="o">=</span>network.target
<span class="o">[</span>Service<span class="o">]</span>
<span class="nv">Type</span><span class="o">=</span>forking
<span class="nv">WorkingDirectory</span><span class="o">=</span>/data/monitor/mysqld_exporter
<span class="nv">ExecStart</span><span class="o">=</span>/data/monitor/mysqld_exporter/start.sh
<span class="o">[</span>Install<span class="o">]</span>
<span class="nv">WantedBy</span><span class="o">=</span>multi-user.target
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"><span class="c1">#设置开机自启</span>
systemctl daemon-reload
systemctl <span class="nb">enable</span> mysqld_exporter
stemctl start mysqld_exporter
</code></pre></td></tr></table>
</div>
</div><h4 id="614-启动后的访问端是-启-9104访问访-http数据库服务器-数-ip9104metrics">6.1.4 启动后的访问端⼝是 启 9104：访问访 http://数据库服务器 数 ip:9104/metrics</h4>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/image/20210721200801.png"
        data-srcset="/image/20210721200801.png, /image/20210721200801.png 1.5x, /image/20210721200801.png 2x"
        data-sizes="auto"
        alt="/image/20210721200801.png"
        title="/image/20210721200801.png" /></p>
<h3 id="62-把-mysql_exporter-这个采集程序接配置到-这-prometheusyml-参照下图参考文件prometheusyml">6.2 把 mysql_exporter 这个采集程序接⼊配置到 这 prometheus.yml 参照下图<a href="/prometheus.yml" rel="">参考文件</a>
</h3>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/image/20210722121326.png"
        data-srcset="/image/20210722121326.png, /image/20210722121326.png 1.5x, /image/20210722121326.png 2x"
        data-sizes="auto"
        alt="/image/20210722121326.png"
        title="/image/20210722121326.png" /></p>
<p><strong>导⼊node_exporter 后，重新载⼊配置 :</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">curl -X POST http://localhost:9090/prometheus/-/reload
</code></pre></td></tr></table>
</div>
</div><h3 id="63配置配-grafana管理后台这一步可以省略">6.3配置配 grafana管理后台(这一步可以省略)</h3>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/image/20210721202540.png"
        data-srcset="/image/20210721202540.png, /image/20210721202540.png 1.5x, /image/20210721202540.png 2x"
        data-sizes="auto"
        alt="/image/20210721202540.png"
        title="/image/20210721202540.png" /></p>
<h4 id="631-上传上-mysql监控模板--下载更多面板链接httpsgrafanacomgrafanadashboardssearchmysql">6.3.1 上传上 mysql监控模板  <a href="https://grafana.com/grafana/dashboards?search=mysql" target="_blank" rel="noopener noreffer">下载更多面板链接</a>
</h4>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/image/20210722111032.png"
        data-srcset="/image/20210722111032.png, /image/20210722111032.png 1.5x, /image/20210722111032.png 2x"
        data-sizes="auto"
        alt="/image/20210722111032.png"
        title="/image/20210722111032.png" /></p>
<p><strong>注：<a href="/%e5%a4%a7%e7%9b%98%e9%85%8d%e7%bd%ae/mysql.json" rel="">下载文mysql大盘</a>
</strong></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/image/20210722111243.png"
        data-srcset="/image/20210722111243.png, /image/20210722111243.png 1.5x, /image/20210722111243.png 2x"
        data-sizes="auto"
        alt="/image/20210722111243.png"
        title="/image/20210722111243.png" /></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/image/20210722111433.png"
        data-srcset="/image/20210722111433.png, /image/20210722111433.png 1.5x, /image/20210722111433.png 2x"
        data-sizes="auto"
        alt="/image/20210722111433.png"
        title="/image/20210722111433.png" /></p>
<h2 id="7-设置邮件告警">7、 设置邮件告警</h2>
<p><strong>1、 修改修 grafana 告警配置文件 告 SMTP 邮箱配置修改邮箱相关的配置，例如下面。重启 grafan 系统。 vim /data/monitor/grafana/conf/defaults.ini</strong></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/image/20210722154300.png"
        data-srcset="/image/20210722154300.png, /image/20210722154300.png 1.5x, /image/20210722154300.png 2x"
        data-sizes="auto"
        alt="/image/20210722154300.png"
        title="/image/20210722154300.png" /></p>
<h3 id="2配置通知邮箱-配-在-grafana">2、配置通知邮箱 配 在 grafana</h3>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/image/20210722154604.png"
        data-srcset="/image/20210722154604.png, /image/20210722154604.png 1.5x, /image/20210722154604.png 2x"
        data-sizes="auto"
        alt="/image/20210722154604.png"
        title="/image/20210722154604.png" /></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/image/20210722155134.png"
        data-srcset="/image/20210722155134.png, /image/20210722155134.png 1.5x, /image/20210722155134.png 2x"
        data-sizes="auto"
        alt="/image/20210722155134.png"
        title="/image/20210722155134.png" /></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/image/20210722155401.png"
        data-srcset="/image/20210722155401.png, /image/20210722155401.png 1.5x, /image/20210722155401.png 2x"
        data-sizes="auto"
        alt="/image/20210722155401.png"
        title="/image/20210722155401.png" /></p>
<p><strong>关键字： Template variables are not supported in alert queries</strong></p>
<p><strong>分析： 分 由于Prometheus 告警不支持变量，而模板面板使用了⼤量变量，导致不可使用告警。 解决办法：单独配置个告警的视图，用正则匹配出所有的主机 或者每台主机单独⼀个查询 语句</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml">(1 - (node_memory_MemAvailable_bytes{instance=&#34;101.133.173.223:9100&#34;} / (node_memory_MemTotal_bytes{instance=&#34;101.133.173.223:9100&#34;})))*100
</code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/image/20210724133545.png"
        data-srcset="/image/20210724133545.png, /image/20210724133545.png 1.5x, /image/20210724133545.png 2x"
        data-sizes="auto"
        alt="/image/20210724133545.png"
        title="/image/20210724133545.png" /></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/image/20210724133724.png"
        data-srcset="/image/20210724133724.png, /image/20210724133724.png 1.5x, /image/20210724133724.png 2x"
        data-sizes="auto"
        alt="/image/20210724133724.png"
        title="/image/20210724133724.png" /></p>
<h2 id="8设置其他告警演示设置企业微信群告警">8、设置其他告警，演示设置企业微信群告警</h2>
<p><strong>注： PrometheusAlert全家桶是开源的运维告警中心消息转发系统,支持主流的监控系统Prometheus,Zabbix,日志系统Graylog和数据可视化系统Grafana发出的预警消息,支持钉钉,微信,华为云短信,腾讯云短信,腾讯云电话,阿里云短信,阿里云电话等</strong></p>
<p><a href="https://gitee.com/feiyu563/PrometheusAlert" target="_blank" rel="noopener noreffer">gitee项目地址</a>
  <a href="/package/linux.zip" rel="">下载包</a>
</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"><span class="c1">#如果下载不下来，package文件夹中有liunx.zip包</span>
wget https://github.com/feiyu563/PrometheusAlert/releases/download/v4.4.0/linux.zip

mkdir -p /data/monitor/linux_PrometheusAlert

<span class="c1">#确保解压后文件在/data/monitor/linux_PrometheusAlert夹中</span>
mv linux.zip /data/monitor/linux_PrometheusAlert/ <span class="o">&amp;&amp;</span> <span class="nb">cd</span> /data/monitor/linux_PrometheusAlert/ <span class="o">&amp;&amp;</span> unzip linux.zip <span class="o">&amp;&amp;</span> <span class="nb">cd</span> linux/ <span class="o">&amp;&amp;</span> mv * ../ <span class="o">&amp;&amp;</span> <span class="nb">cd</span> ../ <span class="o">&amp;&amp;</span> rm -rf linux/

<span class="c1">#运行PrometheusAlert</span>
<span class="c1"># ./PrometheusAlert (#后台运行请执行 nohup ./PrometheusAlert &amp;)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="81启动">8.1启动</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">chmod <span class="m">777</span> PrometheusAlert

<span class="nb">cd</span> /data/monitor/linux_PrometheusAlert
<span class="c1">#创建start.sh脚本</span>
vim start.sh
</code></pre></td></tr></table>
</div>
</div><p><strong>start.sh脚本内容如下：</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"><span class="cp">#!/bin/bash
</span><span class="cp"></span>nohup /data/monitor/linux_PrometheusAlert/PrometheusAlert <span class="p">&amp;</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">chmod <span class="m">744</span> start.sh
</code></pre></td></tr></table>
</div>
</div><p><strong>注册服务</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"><span class="c1">#创建启动文件</span>
vim /etc/systemd/system/PrometheusAlert.service
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"><span class="o">[</span>Unit<span class="o">]</span>
<span class="nv">Description</span><span class="o">=</span>mysqld_exporter service
<span class="nv">After</span><span class="o">=</span>network.target
<span class="o">[</span>Service<span class="o">]</span>
<span class="nv">Type</span><span class="o">=</span>forking
<span class="nv">WorkingDirectory</span><span class="o">=</span>/data/monitor/linux_PrometheusAlert/
<span class="nv">ExecStart</span><span class="o">=</span>/data/monitor/linux_PrometheusAlert/start.sh
<span class="o">[</span>Install<span class="o">]</span>
<span class="nv">WantedBy</span><span class="o">=</span>multi-user.target
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"><span class="c1">#设置开机自启</span>
systemctl daemon-reload
systemctl <span class="nb">enable</span> PrometheusAlert
systemctl start PrometheusAlert

<span class="c1">#启动后可使用浏览器打开以下地址查看：http://127.0.0.1:8080</span>
<span class="c1">#默认登录帐号和密码在conf/app.conf中有配置</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="82-企业微信告警配置">8.2 企业微信告警配置</h3>
<p>打开企业微信,进入企业微信群中,选择群设置&ndash;&gt;群机器人&ndash;&gt;添加，可参下图：</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/image/wx1.png"
        data-srcset="/image/wx1.png, /image/wx1.png 1.5x, /image/wx1.png 2x"
        data-sizes="auto"
        alt="/image/wx1.png"
        title="/image/wx1.png" /></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/image/wx2.png"
        data-srcset="/image/wx2.png, /image/wx2.png 1.5x, /image/wx2.png 2x"
        data-sizes="auto"
        alt="/image/wx2.png"
        title="/image/wx2.png" /></p>
<p><strong>复制图中的Webhook地址，并填入PrometheusAlert配置文件app.conf中对应配置项即可。</strong></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/image/20210724161438.png"
        data-srcset="/image/20210724161438.png, /image/20210724161438.png 1.5x, /image/20210724161438.png 2x"
        data-sizes="auto"
        alt="/image/20210724161438.png"
        title="/image/20210724161438.png" /></p>
<p><strong>企业微信机器人目前支持的markdown语法是如下的子集：</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-markdown" data-lang="markdown">标题 （支持1至6级标题，注意#与文字中间要有空格）
<span class="gh"># 标题一
</span><span class="gh"></span><span class="gu">## 标题二
</span><span class="gu">### 标题三
</span><span class="gu">#### 标题四
</span><span class="gu">##### 标题五
</span><span class="gu">###### 标题六
</span><span class="gu"></span>
加粗
<span class="gs">**bold**</span>

链接
[<span class="nt">这是一个链接</span>](<span class="na">http://work.weixin.qq.com/api/doc</span>)

行内代码段（暂不支持跨行）
<span class="sb">`code`</span>

引用
<span class="k">&gt; </span><span class="ge">引用文字
</span><span class="ge"></span>
字体颜色(只支持3种内置颜色)
<span class="p">&lt;</span><span class="nt">font</span> <span class="na">color</span><span class="o">=</span><span class="s">&#34;info&#34;</span><span class="p">&gt;</span>绿色<span class="p">&lt;/</span><span class="nt">font</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">font</span> <span class="na">color</span><span class="o">=</span><span class="s">&#34;comment&#34;</span><span class="p">&gt;</span>灰色<span class="p">&lt;/</span><span class="nt">font</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">font</span> <span class="na">color</span><span class="o">=</span><span class="s">&#34;warning&#34;</span><span class="p">&gt;</span>橙红色<span class="p">&lt;/</span><span class="nt">font</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/image/20210724161707.png"
        data-srcset="/image/20210724161707.png, /image/20210724161707.png 1.5x, /image/20210724161707.png 2x"
        data-sizes="auto"
        alt="/image/20210724161707.png"
        title="/image/20210724161707.png" /></p>
<p><strong>测试发送机器人</strong></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/image/20210724161851.png"
        data-srcset="/image/20210724161851.png, /image/20210724161851.png 1.5x, /image/20210724161851.png 2x"
        data-sizes="auto"
        alt="/image/20210724161851.png"
        title="/image/20210724161851.png" /></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/image/2f4ed6fc5111cd51b0ff94066c17ac1.jpg"
        data-srcset="/image/2f4ed6fc5111cd51b0ff94066c17ac1.jpg, /image/2f4ed6fc5111cd51b0ff94066c17ac1.jpg 1.5x, /image/2f4ed6fc5111cd51b0ff94066c17ac1.jpg 2x"
        data-sizes="auto"
        alt="/image/2f4ed6fc5111cd51b0ff94066c17ac1.jpg"
        title="/image/2f4ed6fc5111cd51b0ff94066c17ac1.jpg" /></p>
<h4 id="grafana内置固定消息模版接入配置">grafana（内置固定消息模版）接入配置</h4>
<p><strong>首先使用管理员或者具有告警配置权限的帐号登录进Grafana管理页面，登录后进入notification channels配置。</strong></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/image/addchannel.png"
        data-srcset="/image/addchannel.png, /image/addchannel.png 1.5x, /image/addchannel.png 2x"
        data-sizes="auto"
        alt="/image/addchannel.png"
        title="/image/addchannel.png" /></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/image/20210724162256.png"
        data-srcset="/image/20210724162256.png, /image/20210724162256.png 1.5x, /image/20210724162256.png 2x"
        data-sizes="auto"
        alt="/image/20210724162256.png"
        title="/image/20210724162256.png" /></p>
<p><strong>注意这里的url地址填写上自己部署所在的url</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">/grafana/dingding  处理Grafana告警消息转发到钉钉接口，可选参数(ddurl)
/grafana/weixin    处理Grafana告警消息转发到微信接口，可选参数(wxurl)
/grafana/feishu    处理Grafana告警消息转发到飞书接口，可选参数(fsurl)
/grafana/txdx      处理Grafana告警消息转发到腾讯云短信接口，可选参数(phone)
/grafana/txdh      处理Grafana告警消息转发到腾讯云电话接口，可选参数(phone)
/grafana/hwdx      处理Grafana告警消息转发到华为云短信接口，可选参数(phone)
/grafana/bddx      处理Grafana告警消息转发到百度云短信接口，可选参数(phone)
/grafana/alydx     处理Grafana告警消息转发到阿里云短信接口，可选参数(phone)
/grafana/rlydh     处理Grafana告警消息转发到容联云电话接口，可选参数(phone)
/grafana/email     处理Grafana告警消息转发到email接口，可选参数(email)
/grafana/tg        处理Grafana告警消息转发到telegram接口
/grafana/workwechat处理Grafana告警消息转发到企业微信应用接口
</code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/image/20210724162608.png"
        data-srcset="/image/20210724162608.png, /image/20210724162608.png 1.5x, /image/20210724162608.png 2x"
        data-sizes="auto"
        alt="/image/20210724162608.png"
        title="/image/20210724162608.png" /></p>
<p><strong>效果</strong></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/image/83d43352f390a1dabde7f936de6016c.jpg"
        data-srcset="/image/83d43352f390a1dabde7f936de6016c.jpg, /image/83d43352f390a1dabde7f936de6016c.jpg 1.5x, /image/83d43352f390a1dabde7f936de6016c.jpg 2x"
        data-sizes="auto"
        alt="/image/83d43352f390a1dabde7f936de6016c.jpg"
        title="/image/83d43352f390a1dabde7f936de6016c.jpg" /></p>
<h2 id="9参考文档">9.参考文档</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">#Prometheus Alert
https://gitee.com/feiyu563/PrometheusAlert#/feiyu563/PrometheusAlert/blob/master/doc/readme/grafana.md

#grafana创建告警
https://grafana.com/docs/grafana/latest/alerting/old-alerting/create-alerts/
</code></pre></td></tr></table>
</div>
</div><p>注释：大盘json文件  <a href="/%e5%a4%a7%e7%9b%98%e9%85%8d%e7%bd%ae/%e6%94%bf%e5%8a%a1%e5%be%ae%e4%bf%a1%e5%a4%a7%e7%9b%98.json" rel="">下载</a>
</p>
<p><strong>Prometheus常用查询函数 产考连接:https://www.cnblogs.com/xjzyy/p/15346954.html</strong></p>
</div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>更新于 2021-10-20</span>
            </div></div>
        <div class="post-info-line">
            <div class="post-info-md"><span>
                            <a class="link-to-markdown" href="/prometheus-%E7%9B%91%E6%8E%A7%E9%83%A8%E7%BD%B2-last/index.md" target="_blank">阅读原始文档</a>
                        </span></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="分享到 Twitter" data-sharer="twitter" data-url="https://freerun.xyz/prometheus-%E7%9B%91%E6%8E%A7%E9%83%A8%E7%BD%B2-last/" data-title="普罗米修斯Prometheus" data-hashtags="监控"><i class="fab fa-twitter fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="分享到 Hacker News" data-sharer="hackernews" data-url="https://freerun.xyz/prometheus-%E7%9B%91%E6%8E%A7%E9%83%A8%E7%BD%B2-last/" data-title="普罗米修斯Prometheus"><i class="fab fa-hacker-news fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="分享到 Line" data-sharer="line" data-url="https://freerun.xyz/prometheus-%E7%9B%91%E6%8E%A7%E9%83%A8%E7%BD%B2-last/" data-title="普罗米修斯Prometheus"><i data-svg-src="https://cdn.jsdelivr.net/npm/simple-icons@6.20.0/icons/line.svg" aria-hidden="true"></i></a><a href="javascript:void(0);" title="分享到 微博" data-sharer="weibo" data-url="https://freerun.xyz/prometheus-%E7%9B%91%E6%8E%A7%E9%83%A8%E7%BD%B2-last/" data-title="普罗米修斯Prometheus"><i class="fab fa-weibo fa-fw" aria-hidden="true"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/tags/%E7%9B%91%E6%8E%A7/">监控</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">返回</a></span>&nbsp;|&nbsp;<span><a href="/">主页</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/linux%E6%89%A9%E5%AE%B9home%E7%9B%AE%E5%BD%95/" class="prev" rel="prev" title="Linux扩容home目录"><i class="fas fa-angle-left fa-fw" aria-hidden="true"></i>Linux扩容home目录</a>
            <a href="/linux%E7%B3%BB%E7%BB%9F%E4%B8%8B%E6%8F%90%E7%A4%BA%E7%A3%81%E7%9B%98%E7%A9%BA%E9%97%B4%E6%BB%A1%E4%BD%86%E5%AE%9E%E9%99%85%E5%8D%A0%E7%94%A8%E5%8D%B4%E5%BE%88%E5%B0%8F/" class="next" rel="next" title="Linux系统下提示磁盘空间满,但实际占用却很小">Linux系统下提示磁盘空间满,但实际占用却很小<i class="fas fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
<div id="comments"><div id="valine" class="comment"></div><noscript>
                Please enable JavaScript to view the comments powered by <a href="https://valine.js.org/">Valine</a>.
            </noscript></div></article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">由 <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.82.1">Hugo</a> 强力驱动 | 主题 - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="noopener noreffer" title="LoveIt 0.2.10"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden="true"></i> LoveIt</a>
                </div><div class="footer-line" itemscope itemtype="http://schema.org/CreativeWork"><i class="far fa-copyright fa-fw" aria-hidden="true"></i><span itemprop="copyrightYear">2020 - 2023</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="https://github.com/liuxiaoquan/free-programming-books-zh_CN" target="_blank">Ylimhs</a></span>&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="回到顶部">
                <i class="fas fa-arrow-up fa-fw" aria-hidden="true"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="查看评论">
                <i class="fas fa-comment fa-fw" aria-hidden="true"></i>
            </a>
        </div><link rel="stylesheet" href="/lib/valine/valine.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/contrib/copy-tex.min.css"><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/valine@1.4.18/dist/Valine.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/smooth-scroll@16.1.3/dist/smooth-scroll.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/autocomplete.js@0.38.1/dist/autocomplete.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lunr@2.3.9/lunr.min.js"></script><script type="text/javascript" src="/lib/lunr/lunr.stemmer.support.min.js"></script><script type="text/javascript" src="/lib/lunr/lunr.zh.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lazysizes@5.3.1/lazysizes.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/contrib/auto-render.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/contrib/copy-tex.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/contrib/mhchem.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"复制到剪贴板","maxShownLines":50},"comment":{"valine":{"appId":"sefjwilEDKwNVnigxFWyayLz-gzGzoHsz","appKey":"J1UwLyDDdsY591CR1n1oQGe5","avatar":"mp","el":"#valine","emojiCDN":"https://cdn.jsdelivr.net/npm/emoji-datasource-google@14.0.0/img/google/64/","emojiMaps":{"100":"1f4af.png","alien":"1f47d.png","anger":"1f4a2.png","angry":"1f620.png","anguished":"1f627.png","astonished":"1f632.png","black_heart":"1f5a4.png","blue_heart":"1f499.png","blush":"1f60a.png","bomb":"1f4a3.png","boom":"1f4a5.png","broken_heart":"1f494.png","brown_heart":"1f90e.png","clown_face":"1f921.png","cold_face":"1f976.png","cold_sweat":"1f630.png","confounded":"1f616.png","confused":"1f615.png","cry":"1f622.png","crying_cat_face":"1f63f.png","cupid":"1f498.png","dash":"1f4a8.png","disappointed":"1f61e.png","disappointed_relieved":"1f625.png","dizzy":"1f4ab.png","dizzy_face":"1f635.png","drooling_face":"1f924.png","exploding_head":"1f92f.png","expressionless":"1f611.png","face_vomiting":"1f92e.png","face_with_cowboy_hat":"1f920.png","face_with_hand_over_mouth":"1f92d.png","face_with_head_bandage":"1f915.png","face_with_monocle":"1f9d0.png","face_with_raised_eyebrow":"1f928.png","face_with_rolling_eyes":"1f644.png","face_with_symbols_on_mouth":"1f92c.png","face_with_thermometer":"1f912.png","fearful":"1f628.png","flushed":"1f633.png","frowning":"1f626.png","ghost":"1f47b.png","gift_heart":"1f49d.png","green_heart":"1f49a.png","grimacing":"1f62c.png","grin":"1f601.png","grinning":"1f600.png","hankey":"1f4a9.png","hear_no_evil":"1f649.png","heart":"2764-fe0f.png","heart_decoration":"1f49f.png","heart_eyes":"1f60d.png","heart_eyes_cat":"1f63b.png","heartbeat":"1f493.png","heartpulse":"1f497.png","heavy_heart_exclamation_mark_ornament":"2763-fe0f.png","hole":"1f573-fe0f.png","hot_face":"1f975.png","hugging_face":"1f917.png","hushed":"1f62f.png","imp":"1f47f.png","innocent":"1f607.png","japanese_goblin":"1f47a.png","japanese_ogre":"1f479.png","joy":"1f602.png","joy_cat":"1f639.png","kiss":"1f48b.png","kissing":"1f617.png","kissing_cat":"1f63d.png","kissing_closed_eyes":"1f61a.png","kissing_heart":"1f618.png","kissing_smiling_eyes":"1f619.png","laughing":"1f606.png","left_speech_bubble":"1f5e8-fe0f.png","love_letter":"1f48c.png","lying_face":"1f925.png","mask":"1f637.png","money_mouth_face":"1f911.png","nauseated_face":"1f922.png","nerd_face":"1f913.png","neutral_face":"1f610.png","no_mouth":"1f636.png","open_mouth":"1f62e.png","orange_heart":"1f9e1.png","partying_face":"1f973.png","pensive":"1f614.png","persevere":"1f623.png","pleading_face":"1f97a.png","pouting_cat":"1f63e.png","purple_heart":"1f49c.png","rage":"1f621.png","relaxed":"263a-fe0f.png","relieved":"1f60c.png","revolving_hearts":"1f49e.png","right_anger_bubble":"1f5ef-fe0f.png","robot_face":"1f916.png","rolling_on_the_floor_laughing":"1f923.png","scream":"1f631.png","scream_cat":"1f640.png","see_no_evil":"1f648.png","shushing_face":"1f92b.png","skull":"1f480.png","skull_and_crossbones":"2620-fe0f.png","sleeping":"1f634.png","sleepy":"1f62a.png","slightly_frowning_face":"1f641.png","slightly_smiling_face":"1f642.png","smile":"1f604.png","smile_cat":"1f638.png","smiley":"1f603.png","smiley_cat":"1f63a.png","smiling_face_with_3_hearts":"1f970.png","smiling_imp":"1f608.png","smirk":"1f60f.png","smirk_cat":"1f63c.png","sneezing_face":"1f927.png","sob":"1f62d.png","space_invader":"1f47e.png","sparkling_heart":"1f496.png","speak_no_evil":"1f64a.png","speech_balloon":"1f4ac.png","star-struck":"1f929.png","stuck_out_tongue":"1f61b.png","stuck_out_tongue_closed_eyes":"1f61d.png","stuck_out_tongue_winking_eye":"1f61c.png","sunglasses":"1f60e.png","sweat":"1f613.png","sweat_drops":"1f4a6.png","sweat_smile":"1f605.png","thinking_face":"1f914.png","thought_balloon":"1f4ad.png","tired_face":"1f62b.png","triumph":"1f624.png","two_hearts":"1f495.png","unamused":"1f612.png","upside_down_face":"1f643.png","weary":"1f629.png","white_frowning_face":"2639-fe0f.png","white_heart":"1f90d.png","wink":"1f609.png","woozy_face":"1f974.png","worried":"1f61f.png","yawning_face":"1f971.png","yellow_heart":"1f49b.png","yum":"1f60b.png","zany_face":"1f92a.png","zipper_mouth_face":"1f910.png","zzz":"1f4a4.png"},"enableQQ":true,"highlight":true,"lang":"zh-cn","pageSize":10,"placeholder":"说点什么吧...","recordIP":true,"visitor":true}},"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":true,"left":"\\begin{equation}","right":"\\end{equation}"},{"display":true,"left":"\\begin{equation*}","right":"\\end{equation*}"},{"display":true,"left":"\\begin{align}","right":"\\end{align}"},{"display":true,"left":"\\begin{align*}","right":"\\end{align*}"},{"display":true,"left":"\\begin{alignat}","right":"\\end{alignat}"},{"display":true,"left":"\\begin{alignat*}","right":"\\end{alignat*}"},{"display":true,"left":"\\begin{gather}","right":"\\end{gather}"},{"display":true,"left":"\\begin{CD}","right":"\\end{CD}"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false},"search":{"highlightTag":"em","lunrIndexURL":"/index.json","lunrLanguageCode":"zh","lunrSegmentitURL":"/lib/lunr/lunr.segmentit.js","maxResultLength":10,"noResultsFound":"没有找到结果","snippetLength":50,"type":"lunr"}};</script><script type="text/javascript" src="/js/theme.min.js"></script></body>
</html>
